

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rutinas_fuzzy &mdash; documentación de Laboratorio Virtual de sistemas de control clasicos y difusos utilizando software libre - 1.0</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Laboratorio Virtual de sistemas de control clasicos y difusos utilizando software libre
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contenido:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../codigos/Promociones.html">Promociones de Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../codigos/Principal.html">Archivo principal (main)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Laboratorio Virtual de sistemas de control clasicos y difusos utilizando software libre</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Código de módulo</a> &raquo;</li>
        
      <li>rutinas_fuzzy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Código fuente para rutinas_fuzzy</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">Archivo que contiene las clases FuzzyController y FISParser, para administrar el controlador difuso y cargar y exportar archivos .fis respectivamente</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">from</span> <span class="nn">skfuzzymdf.control.visualization</span> <span class="kn">import</span> <span class="n">FuzzyVariableVisualizer</span>
<span class="kn">from</span> <span class="nn">skfuzzymdf.control.controlsystem</span> <span class="kn">import</span> <span class="n">CrispValueCalculator</span>
<span class="kn">from</span> <span class="nn">skfuzzymdf.fuzzymath.fuzzy_ops</span> <span class="kn">import</span> <span class="n">interp_membership</span>
<span class="kn">from</span> <span class="nn">skfuzzymdf.membership</span> <span class="kn">import</span> <span class="n">generatemf</span>
<span class="kn">from</span> <span class="nn">skfuzzymdf</span> <span class="kn">import</span> <span class="n">control</span> <span class="k">as</span> <span class="n">fuzz</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">parse</span> <span class="kn">import</span> <span class="n">parse</span>

<span class="kn">import</span> <span class="nn">pyqtgraphmdf</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">re</span>


<div class="viewcode-block" id="FuzzyController"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController">[documentos]</a><span class="k">class</span> <span class="nc">FuzzyController</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clase para administrar el controlador difuso, a partir de la misma se puede crear el controlador difuso e ir creandolo de forma programatica por medio de la interfaz grafica definida en Ui_VentanaPrincipal.py y manejada en FuzzyHandler.py</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FuzzyController.__init__"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.__init__">[documentos]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputlist</span><span class="p">,</span> <span class="n">outputlist</span><span class="p">,</span> <span class="n">rulelist</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Se utiliza para inicializar el controlador con las entradas y salidas del mismo, en caso de que se envie el parametro opcional, rulelist, se crea el controlador a partir de las reglas suministradas y queda listo para usar</span>
<span class="sd">        </span>
<span class="sd">        :param inputlist: Lista de variables de entrada</span>
<span class="sd">        :type inputlist: list</span>
<span class="sd">        :param outputlist: Lista de variables de salida</span>
<span class="sd">        :type outputlist: list</span>
<span class="sd">        :param rulelist: Lista de reglas, defaults to []</span>
<span class="sd">        :type rulelist: list, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crear_input</span><span class="p">(</span><span class="n">inputlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crear_output</span><span class="p">(</span><span class="n">outputlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flagpyqt</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Rotacion de colores para las funciones de membresia</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;#1f77b4&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#ff7f0e&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#2ca02c&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#d62728&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#9467bd&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#8c564b&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#e377c2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#7f7f7f&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#bcbd22&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#17becf&#39;</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inlabelsplot</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inareas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invalues</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">outlabelsplot</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outareas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outvalues</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">crear_etiquetas_input</span><span class="p">(</span><span class="n">inputlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crear_etiquetas_output</span><span class="p">(</span><span class="n">outputlist</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rulelist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crear_reglas</span><span class="p">(</span><span class="n">rulelist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crear_controlador</span><span class="p">()</span></div>

<div class="viewcode-block" id="FuzzyController.crear_input"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.crear_input">[documentos]</a>    <span class="k">def</span> <span class="nf">crear_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para crear las variables de entrada a partir de la lista de variables de entrada</span>
<span class="sd">        </span>
<span class="sd">        :param inputlist: Lista de variables de entrada</span>
<span class="sd">        :type inputlist: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vector</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ins</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inputlist</span><span class="p">):</span>
            <span class="n">temp_in</span> <span class="o">=</span> <span class="n">fuzz</span><span class="o">.</span><span class="n">Antecedent</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">ins</span><span class="p">[</span><span class="s1">&#39;rango&#39;</span><span class="p">],</span> <span class="mi">501</span><span class="p">),</span> <span class="n">ins</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">])</span>
            <span class="n">vector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_in</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vector</span></div>

<div class="viewcode-block" id="FuzzyController.crear_output"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.crear_output">[documentos]</a>    <span class="k">def</span> <span class="nf">crear_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outputlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para crear las variables de salida a partir de la lista de variables de salida</span>
<span class="sd">        </span>
<span class="sd">        :param outputlist: Lista de variables de salida</span>
<span class="sd">        :type outputlist: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vector</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ins</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outputlist</span><span class="p">):</span>
            <span class="n">temp_in</span> <span class="o">=</span> <span class="n">fuzz</span><span class="o">.</span><span class="n">Consequent</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">ins</span><span class="p">[</span><span class="s1">&#39;rango&#39;</span><span class="p">],</span> <span class="mi">501</span><span class="p">),</span>
                                      <span class="n">ins</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">],</span>
                                      <span class="n">ins</span><span class="p">[</span><span class="s1">&#39;metodo&#39;</span><span class="p">])</span>
            <span class="n">vector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_in</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vector</span></div>

<div class="viewcode-block" id="FuzzyController.crear_etiquetas_input"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.crear_etiquetas_input">[documentos]</a>    <span class="k">def</span> <span class="nf">crear_etiquetas_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para crear las etiquetas de una entrada a partir de la lista de variables de entrada</span>
<span class="sd">        </span>
<span class="sd">        :param inputlist: Lista de variables de entrada</span>
<span class="sd">        :type inputlist: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inputlist</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">eti</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">generatemf</span><span class="p">,</span> <span class="n">eti</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">])(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span> <span class="o">*</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;definicion&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="FuzzyController.crear_etiquetas_output"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.crear_etiquetas_output">[documentos]</a>    <span class="k">def</span> <span class="nf">crear_etiquetas_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outputlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para crear las etiquetas de una salida a partir de la lista de variables de salida</span>
<span class="sd">        </span>
<span class="sd">        :param outputlist: Lista de variables de salida</span>
<span class="sd">        :type outputlist: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outputlist</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">eti</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">generatemf</span><span class="p">,</span> <span class="n">eti</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">])(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span> <span class="o">*</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;definicion&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="FuzzyController.graficar_mf_in"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.graficar_mf_in">[documentos]</a>    <span class="k">def</span> <span class="nf">graficar_mf_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para graficar las funciones de membresia de una entrada</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param i: Numero de entrada</span>
<span class="sd">        :type i: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">inputgraphicsView</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">FuzzyVariableVisualizer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">inputgraphicsView</span><span class="p">,</span>
                                <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">inputgraphicsView</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span><span class="o">.</span><span class="n">view_gui</span><span class="p">()</span>
        <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">inputgraphicsView</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
        <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">inputgraphicsView</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">inputgraphicsView</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="FuzzyController.graficar_mf_out"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.graficar_mf_out">[documentos]</a>    <span class="k">def</span> <span class="nf">graficar_mf_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para graficar las funciones de membresia de una salida</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param o: Numero de salida</span>
<span class="sd">        :type o: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">outputgraphicsView</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">FuzzyVariableVisualizer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">],</span>
                                <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">outputgraphicsView</span><span class="p">,</span>
                                <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">outputgraphicsView</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span><span class="o">.</span><span class="n">view_gui</span><span class="p">()</span>
        <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">outputgraphicsView</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
        <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">outputgraphicsView</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">window</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">outputgraphicsView</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="FuzzyController.cambiar_nombre_input"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.cambiar_nombre_input">[documentos]</a>    <span class="k">def</span> <span class="nf">cambiar_nombre_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">nombre</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcio para cambiar el nombre de una entrada</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param i: Numero de entrada</span>
<span class="sd">        :type i: int</span>
<span class="sd">        :param nombre: Nuevo nombre de la entrada</span>
<span class="sd">        :type nombre: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">nombre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_in</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.cambiar_nombre_output"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.cambiar_nombre_output">[documentos]</a>    <span class="k">def</span> <span class="nf">cambiar_nombre_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">nombre</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Funcio para cambiar el nombre de una salida</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param o: Numero de salida</span>
<span class="sd">        :type o: int</span>
<span class="sd">        :param nombre: Nuevo nombre de la salida</span>
<span class="sd">        :type nombre: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">nombre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_out</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.cambio_etiquetas_input"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.cambio_etiquetas_input">[documentos]</a>    <span class="k">def</span> <span class="nf">cambio_etiquetas_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">inputlist</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para actualizar las etiquetas de entrada del controlador</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param inputlist: Lista de variables de entrada</span>
<span class="sd">        :type inputlist: list</span>
<span class="sd">        :param i: Numero de entrada</span>
<span class="sd">        :type i: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crear_etiquetas_input</span><span class="p">(</span><span class="n">inputlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_in</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.cambio_etiquetas_output"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.cambio_etiquetas_output">[documentos]</a>    <span class="k">def</span> <span class="nf">cambio_etiquetas_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">outputlist</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para actualizar las etiquetas de salida del controlador</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param outputlist: Lista de variables de salida</span>
<span class="sd">        :type outputlist: list</span>
<span class="sd">        :param o: Numero de salida</span>
<span class="sd">        :type o: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crear_etiquetas_output</span><span class="p">(</span><span class="n">outputlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_out</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.update_rango_input"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.update_rango_input">[documentos]</a>    <span class="k">def</span> <span class="nf">update_rango_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">inputlist</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para actualizar el universo de discurso de una entrada</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param inputlist: Lista de variables de entrada</span>
<span class="sd">        :type inputlist: list</span>
<span class="sd">        :param i: Numero de entrada</span>
<span class="sd">        :type i: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">inputlist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;rango&#39;</span><span class="p">],</span>
                                                              <span class="mi">501</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_in</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.update_rango_output"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.update_rango_output">[documentos]</a>    <span class="k">def</span> <span class="nf">update_rango_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">outputlist</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para actualizar el universo de discurso de una salida</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param outputlist: Lista de variables de salida</span>
<span class="sd">        :type outputlist: list</span>
<span class="sd">        :param o: Numero de salida</span>
<span class="sd">        :type o: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">outputlist</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="s1">&#39;rango&#39;</span><span class="p">],</span> <span class="mi">501</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_out</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.cambiar_metodo"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.cambiar_metodo">[documentos]</a>    <span class="k">def</span> <span class="nf">cambiar_metodo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">metodo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Funcion para cambiar el metodo de defuzzificacion de una salida</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param o: Numero de salida</span>
<span class="sd">        :type o: int</span>
<span class="sd">        :param metodo: Nombre del nuevo metodo de defuzzificacion</span>
<span class="sd">        :type o: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">defuzzify_method</span> <span class="o">=</span> <span class="n">metodo</span></div>

<div class="viewcode-block" id="FuzzyController.cambio_etinombre_input"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.cambio_etinombre_input">[documentos]</a>    <span class="k">def</span> <span class="nf">cambio_etinombre_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">inputlist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">old_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcio para cambiar el nombre de una etiqueta en la entrada seleccionada</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param inputlist: Lista de variables de entrada</span>
<span class="sd">        :type inputlist: list</span>
<span class="sd">        :param i: Numero de entrada</span>
<span class="sd">        :type i: int</span>
<span class="sd">        :param n: Numero de etiqueta</span>
<span class="sd">        :type n: int</span>
<span class="sd">        :param old_name: Nombre anterior</span>
<span class="sd">        :type old_name: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eti</span> <span class="o">=</span> <span class="n">inputlist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">generatemf</span><span class="p">,</span> <span class="n">eti</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">])(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span> <span class="o">*</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;definicion&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_in</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.cambio_etinombre_output"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.cambio_etinombre_output">[documentos]</a>    <span class="k">def</span> <span class="nf">cambio_etinombre_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">outputlist</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">old_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcio para cambiar el nombre de una etiqueta en la salida seleccionada</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param outputlist: Lista de variables de salida</span>
<span class="sd">        :type outputlist: list</span>
<span class="sd">        :param o: Numero de salida</span>
<span class="sd">        :type o: int</span>
<span class="sd">        :param n: Numero de etiqueta</span>
<span class="sd">        :type n: int</span>
<span class="sd">        :param old_name: Nombre anterior</span>
<span class="sd">        :type old_name: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eti</span> <span class="o">=</span> <span class="n">outputlist</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">generatemf</span><span class="p">,</span> <span class="n">eti</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">])(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span> <span class="o">*</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;definicion&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_out</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.update_definicion_input"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.update_definicion_input">[documentos]</a>    <span class="k">def</span> <span class="nf">update_definicion_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">inputlist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para actualizar la definicion de una funcion de membresia en la entrada seleccionada</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param inputlist: Lista de variables de entrada</span>
<span class="sd">        :type inputlist: list</span>
<span class="sd">        :param i: Numero de entrada</span>
<span class="sd">        :type i: int</span>
<span class="sd">        :param n: Numero de etiqueta</span>
<span class="sd">        :type n: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eti</span> <span class="o">=</span> <span class="n">inputlist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">generatemf</span><span class="p">,</span> <span class="n">eti</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">])(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span> <span class="o">*</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;definicion&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_in</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.update_definicion_output"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.update_definicion_output">[documentos]</a>    <span class="k">def</span> <span class="nf">update_definicion_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">outputlist</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para actualizar la definicion de una funcion de membresia en la salida seleccionada</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param outputlist: Lista de variables de salida</span>
<span class="sd">        :type outputlist: list</span>
<span class="sd">        :param o: Numero de salida</span>
<span class="sd">        :type o: int</span>
<span class="sd">        :param n: Numero de etiqueta</span>
<span class="sd">        :type n: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eti</span> <span class="o">=</span> <span class="n">outputlist</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">generatemf</span><span class="p">,</span> <span class="n">eti</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">])(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span> <span class="o">*</span><span class="n">eti</span><span class="p">[</span><span class="s1">&#39;definicion&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_mf_out</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.crear_reglas"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.crear_reglas">[documentos]</a>    <span class="k">def</span> <span class="nf">crear_reglas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rulelistC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para crear las reglas a partir de una lista que contiene toda la informacion necesaria, esta lista es creada en FuzzyHandler.py:</span>
<span class="sd">        </span>
<span class="sd">        Cada posicion en la lista contiene un set de entradas, salidas y la logica a utilizar (AND o OR), a su vez, cada set es una lista que posee en cada posicion otra lista con la etiqueta, el numero de entrada/salida y si esta o no negada para el caso de las entradas, en caso de ser salida contiene el peso asignado</span>
<span class="sd">        </span>
<span class="sd">        :param rulelistC: Lista con la informacion necesaria para crear las reglas</span>
<span class="sd">        :type rulelistC: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Un set por cada regla</span>
        <span class="k">for</span> <span class="n">sets</span> <span class="ow">in</span> <span class="n">rulelistC</span><span class="p">:</span>
            <span class="n">Etiquetasin</span><span class="p">,</span> <span class="n">Etiquetasout</span><span class="p">,</span> <span class="n">logica</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">sets</span><span class="p">)</span>

            <span class="c1"># Creacion del objeto de regla de Scikit-Fuzzy</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fuzz</span><span class="o">.</span><span class="n">Rule</span><span class="p">())</span>

            <span class="c1"># Los antecedentes deben inicializarce antes de poder expandirse de forma programatica</span>
            <span class="n">inetiqueta_ini</span><span class="p">,</span> <span class="n">ni_ini</span><span class="p">,</span> <span class="n">negacion_ini</span> <span class="o">=</span> <span class="n">Etiquetasin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">negacion_ini</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">ni_ini</span><span class="p">][</span><span class="n">inetiqueta_ini</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">ni_ini</span><span class="p">][</span><span class="n">inetiqueta_ini</span><span class="p">]</span>

            <span class="c1"># Los consecuentes deben inicializarce antes de poder expandirse de forma programatica</span>
            <span class="n">outetiqueta_oni</span><span class="p">,</span> <span class="n">no_ini</span><span class="p">,</span> <span class="n">weight_ini</span> <span class="o">=</span> <span class="n">Etiquetasout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">no_ini</span><span class="p">][</span><span class="n">outetiqueta_oni</span><span class="p">]</span> <span class="o">%</span> <span class="n">weight_ini</span>

            <span class="c1"># Expansion del antecedente de forma programatica</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Etiquetasin</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">Etiquetasin</span><span class="p">)]:</span>
                <span class="k">if</span> <span class="n">logica</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                            <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                            <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">&amp;</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                            <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                            <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">|</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

            <span class="c1"># Expansion del consecuente de forma programatica</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">Etiquetasout</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">Etiquetasout</span><span class="p">)]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">%</span> <span class="n">o</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span></div>

<div class="viewcode-block" id="FuzzyController.agregar_regla"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.agregar_regla">[documentos]</a>    <span class="k">def</span> <span class="nf">agregar_regla</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">Etiquetasin</span><span class="p">,</span> <span class="n">Etiquetasout</span><span class="p">,</span> <span class="n">logica</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para crear una regla a partir de un set</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param Etiquetasin: set de entrada</span>
<span class="sd">        :type Etiquetasin: list</span>
<span class="sd">        :param Etiquetasout: set de salida</span>
<span class="sd">        :type Etiquetasout: list</span>
<span class="sd">        :param logica: Logica a utilizar</span>
<span class="sd">        :type logica: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Creacion del objeto de regla de Scikit-Fuzzy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fuzz</span><span class="o">.</span><span class="n">Rule</span><span class="p">())</span>

        <span class="c1"># Los antecedentes deben inicializarce antes de poder expandirse de forma programatica</span>
        <span class="n">inetiqueta_ini</span><span class="p">,</span> <span class="n">ni_ini</span><span class="p">,</span> <span class="n">negacion_ini</span> <span class="o">=</span> <span class="n">Etiquetasin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">negacion_ini</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">ni_ini</span><span class="p">][</span><span class="n">inetiqueta_ini</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">ni_ini</span><span class="p">][</span><span class="n">inetiqueta_ini</span><span class="p">]</span>

        <span class="c1"># Los consecuentes deben inicializarce antes de poder expandirse de forma programatica</span>
        <span class="n">outetiqueta_oni</span><span class="p">,</span> <span class="n">no_ini</span><span class="p">,</span> <span class="n">weight_ini</span> <span class="o">=</span> <span class="n">Etiquetasout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
            <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">no_ini</span><span class="p">][</span><span class="n">outetiqueta_oni</span><span class="p">]</span> <span class="o">%</span> <span class="n">weight_ini</span>

        <span class="c1"># Expansion del antecedente de forma programatica</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Etiquetasin</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">Etiquetasin</span><span class="p">)]:</span>
            <span class="k">if</span> <span class="n">logica</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                        <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                        <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">&amp;</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                        <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                        <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">|</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># Expansion del consecuente de forma programatica</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">Etiquetasout</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">Etiquetasout</span><span class="p">)]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">%</span> <span class="n">o</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="FuzzyController.eliminar_regla"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.eliminar_regla">[documentos]</a>    <span class="k">def</span> <span class="nf">eliminar_regla</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_rule</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para eliminar una regla</span>
<span class="sd">        </span>
<span class="sd">        :param index_rule: Indice indicando la regla a eliminar</span>
<span class="sd">        :type index_rule: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span></div>

<div class="viewcode-block" id="FuzzyController.cambiar_regla"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.cambiar_regla">[documentos]</a>    <span class="k">def</span> <span class="nf">cambiar_regla</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">Etiquetasin</span><span class="p">,</span> <span class="n">Etiquetasout</span><span class="p">,</span> <span class="n">index_rule</span><span class="p">,</span> <span class="n">logica</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para cambiar una regla a partir de un nuevo set</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param Etiquetasin: set de entrada</span>
<span class="sd">        :type Etiquetasin: list</span>
<span class="sd">        :param Etiquetasout: set de salida</span>
<span class="sd">        :type Etiquetasout: list</span>
<span class="sd">        :param index_rule: Indice indicando la regla a cambiar</span>
<span class="sd">        :type index_rule: int</span>
<span class="sd">        :param logica: Logica a utilizar</span>
<span class="sd">        :type logica: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span>

        <span class="c1"># Creacion del objeto de regla de Scikit-Fuzzy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">index_rule</span><span class="p">,</span> <span class="n">fuzz</span><span class="o">.</span><span class="n">Rule</span><span class="p">())</span>

        <span class="c1"># Los antecedentes deben inicializarce antes de poder expandirse de forma programatica</span>
        <span class="n">inetiqueta_ini</span><span class="p">,</span> <span class="n">ni_ini</span><span class="p">,</span> <span class="n">negacion_ini</span> <span class="o">=</span> <span class="n">Etiquetasin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">negacion_ini</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">ni_ini</span><span class="p">][</span>
                <span class="n">inetiqueta_ini</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                <span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">ni_ini</span><span class="p">][</span><span class="n">inetiqueta_ini</span><span class="p">]</span>

        <span class="c1"># Los consecuentes deben inicializarce antes de poder expandirse de forma programatica</span>
        <span class="n">outetiqueta_oni</span><span class="p">,</span> <span class="n">no_ini</span><span class="p">,</span> <span class="n">weight_ini</span> <span class="o">=</span> <span class="n">Etiquetasout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">no_ini</span><span class="p">][</span>
            <span class="n">outetiqueta_oni</span><span class="p">]</span> <span class="o">%</span> <span class="n">weight_ini</span>

        <span class="c1"># Expansion del antecedente de forma programatica</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Etiquetasin</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">Etiquetasin</span><span class="p">)]:</span>
            <span class="k">if</span> <span class="n">logica</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                        <span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                        <span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">&amp;</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                        <span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span>
                        <span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">antecedent</span> <span class="o">|</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># Expansion del consecuente de forma programatica</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">Etiquetasout</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">Etiquetasout</span><span class="p">)]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">%</span>
                                                        <span class="n">o</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">[</span><span class="n">index_rule</span><span class="p">]</span></div>

<div class="viewcode-block" id="FuzzyController.crear_controlador"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.crear_controlador">[documentos]</a>    <span class="k">def</span> <span class="nf">crear_controlador</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Funcion para crear el controlador difuso a partir de todas las reglas creadas &quot;&quot;&quot;</span>
        
        <span class="n">temp</span> <span class="o">=</span> <span class="n">fuzz</span><span class="o">.</span><span class="n">ControlSystem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rulelist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span> <span class="o">=</span> <span class="n">fuzz</span><span class="o">.</span><span class="n">ControlSystemSimulation</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">flush_after_run</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.prueba_de_controlador"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.prueba_de_controlador">[documentos]</a>    <span class="k">def</span> <span class="nf">prueba_de_controlador</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">no</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para realizar la prueba del controlador</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param values: Valores de entradas dados por el usuario con los sliders</span>
<span class="sd">        :type values: list</span>
<span class="sd">        :param ni: Numero de entradas</span>
<span class="sd">        :type ni: int</span>
<span class="sd">        :param no: Numero de salidas</span>
<span class="sd">        :type no: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Para crear los objetos de graficacion de PyQtGraph una sola vez</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flagpyqt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crear_plots_in</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">ni</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crear_plots_out</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">no</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flagpyqt</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graficar_prueba_pyqtgraph</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">no</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.crear_plots_in"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.crear_plots_in">[documentos]</a>    <span class="k">def</span> <span class="nf">crear_plots_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">ni</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para crear los objetos de graficacion de PyQtGraph de la entrada, el codigo para la obtencion de los valores de salida y el graficado es una version altamente modificada de la funcion .view() de Scikit-Fuzzy. Las modificaciones realizadas fueron necesarias para cambiar matplotlib por PyQtGraph</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param ni: Numero de entradas</span>
<span class="sd">        :type ni: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">):</span>
            <span class="n">window</span><span class="o">.</span><span class="n">ingraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">window</span><span class="o">.</span><span class="n">ingraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">setXRange</span><span class="p">(</span><span class="o">*</span><span class="n">window</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;rango&#39;</span><span class="p">],</span> <span class="mf">0.02</span><span class="p">)</span>

            <span class="n">entradas</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">crispy</span> <span class="o">=</span> <span class="n">CrispValueCalculator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="p">)</span>
            <span class="n">ups_universe</span><span class="p">,</span> <span class="n">output_mf</span><span class="p">,</span> <span class="n">cut_mfs</span> <span class="o">=</span> <span class="n">crispy</span><span class="o">.</span><span class="n">find_memberships</span><span class="p">()</span>
            <span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ups_universe</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

            <span class="n">color</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">entradas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">ingraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span>
                    <span class="n">term</span><span class="o">.</span><span class="n">mf</span><span class="p">,</span>
                    <span class="n">pen</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">pg</span><span class="o">.</span><span class="n">mkColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">])}</span>
                    <span class="p">)</span>
                <span class="p">)</span>

                <span class="n">under_plot</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">ingraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">ups_universe</span><span class="p">,</span>
                    <span class="n">zeros</span><span class="p">,</span>
                    <span class="n">pen</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">pg</span><span class="o">.</span><span class="n">mkColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;6A&#39;</span><span class="p">)}</span>
                <span class="p">)</span>

                <span class="n">over_plot</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">ingraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">ups_universe</span><span class="p">,</span>
                    <span class="n">cut_mfs</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                    <span class="n">pen</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">pg</span><span class="o">.</span><span class="n">mkColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;6A&#39;</span><span class="p">)}</span>
                <span class="p">)</span>

                <span class="n">fillItem</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">FillBetweenItem</span><span class="p">(</span><span class="n">under_plot</span><span class="p">,</span>
                                              <span class="n">over_plot</span><span class="p">,</span>
                                              <span class="n">brush</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">mkColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;6A&#39;</span><span class="p">))</span>

                <span class="n">window</span><span class="o">.</span><span class="n">ingraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">fillItem</span><span class="p">)</span>
                <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">([</span><span class="n">under_plot</span><span class="p">,</span> <span class="n">over_plot</span><span class="p">]))</span>
                <span class="n">color</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Codigo tomado de la funcion .view() de Scikit-Fuzzy y adaptado para su uso con PyQtGraph</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cut_mfs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">output_mf</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">crisp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">crisp_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="mf">0.</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cut_mfs</span><span class="p">:</span>
                            <span class="n">y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                                <span class="n">y</span><span class="p">,</span>
                                <span class="n">interp_membership</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span>
                                                  <span class="n">term</span><span class="o">.</span><span class="n">mf</span><span class="p">,</span>
                                                  <span class="n">crisp_value</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="mf">1.</span>

                    <span class="n">crispPlot</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">ingraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">crisp_value</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
                                                                   <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">]),</span>
                                                                   <span class="n">pen</span><span class="o">=</span><span class="p">{</span>
                                                                       <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                                                                       <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span>
                                                                   <span class="p">})</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">crisp_value</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">crisp_value</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">invalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">crispPlot</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inlabelsplot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">entradas</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inareas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">areas</span><span class="p">))</span></div>

<div class="viewcode-block" id="FuzzyController.crear_plots_out"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.crear_plots_out">[documentos]</a>    <span class="k">def</span> <span class="nf">crear_plots_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">no</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para crear los objetos de graficacion de PyQtGraph de la salida, el codigo para la obtencion de los valores de salida y el graficado es una version altamente modificada de la funcion .view() de Scikit-Fuzzy. Las modificaciones realizadas fueron necesarias para cambiar matplotlib por PyQtGraph</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param no: Numero de salidas</span>
<span class="sd">        :type no: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">):</span>
            <span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">setXRange</span><span class="p">(</span><span class="o">*</span><span class="n">window</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;rango&#39;</span><span class="p">],</span> <span class="mf">0.02</span><span class="p">)</span>

            <span class="n">salidas</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">crispy</span> <span class="o">=</span> <span class="n">CrispValueCalculator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="p">)</span>
            <span class="n">ups_universe</span><span class="p">,</span> <span class="n">output_mf</span><span class="p">,</span> <span class="n">cut_mfs</span> <span class="o">=</span> <span class="n">crispy</span><span class="o">.</span><span class="n">find_memberships</span><span class="p">()</span>
            <span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ups_universe</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

            <span class="n">color</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">salidas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span>
                    <span class="n">term</span><span class="o">.</span><span class="n">mf</span><span class="p">,</span>
                    <span class="n">pen</span><span class="o">=</span><span class="p">{</span>
                        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">pg</span><span class="o">.</span><span class="n">mkColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">])</span>
                    <span class="p">}))</span>

                <span class="n">under_plot</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">ups_universe</span><span class="p">,</span>
                    <span class="n">zeros</span><span class="p">,</span>
                    <span class="n">pen</span><span class="o">=</span><span class="p">{</span>
                        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">pg</span><span class="o">.</span><span class="n">mkColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;6A&#39;</span><span class="p">)</span>
                    <span class="p">})</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cut_mfs</span><span class="p">:</span>
                    <span class="n">over_plot</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="n">ups_universe</span><span class="p">,</span>
                        <span class="n">cut_mfs</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                        <span class="n">pen</span><span class="o">=</span><span class="p">{</span>
                            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">pg</span><span class="o">.</span><span class="n">mkColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;6A&#39;</span><span class="p">)</span>
                        <span class="p">})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">over_plot</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="n">ups_universe</span><span class="p">,</span>
                        <span class="n">zeros</span><span class="p">,</span>
                        <span class="n">pen</span><span class="o">=</span><span class="p">{</span>
                            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">pg</span><span class="o">.</span><span class="n">mkColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;6A&#39;</span><span class="p">)</span>
                        <span class="p">})</span>
                <span class="n">fillItem</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">FillBetweenItem</span><span class="p">(</span><span class="n">under_plot</span><span class="p">,</span>
                                            <span class="n">over_plot</span><span class="p">,</span>
                                            <span class="n">brush</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">mkColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;6A&#39;</span><span class="p">))</span>

                <span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">fillItem</span><span class="p">)</span>
                <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">([</span><span class="n">under_plot</span><span class="p">,</span> <span class="n">over_plot</span><span class="p">]))</span>
                <span class="n">color</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Codigo tomado de la funcion .view() de Scikit-Fuzzy y adaptado para su uso con PyQtGraph</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cut_mfs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">output_mf</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">crisp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">crisp_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="mf">0.</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cut_mfs</span><span class="p">:</span>
                            <span class="n">y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                                <span class="n">y</span><span class="p">,</span>
                                <span class="n">interp_membership</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span>
                                                  <span class="n">term</span><span class="o">.</span><span class="n">mf</span><span class="p">,</span>
                                                  <span class="n">crisp_value</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="mf">1.</span>

                    <span class="n">crispPlot</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">crisp_value</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
                                                                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">]),</span>
                                                                    <span class="n">pen</span><span class="o">=</span><span class="p">{</span>
                                                                        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                                                                        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span>
                                                                    <span class="p">})</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">crisp_value</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">crispPlot</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">crisp_value</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
                                                                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
                                                                    <span class="n">pen</span><span class="o">=</span><span class="p">{</span>
                                                                        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                                                                        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span>
                                                                    <span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">crisp_value</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">crispPlot</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">outgraphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plotwidget</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">crisp_value</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
                                                                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
                                                                    <span class="n">pen</span><span class="o">=</span><span class="p">{</span>
                                                                        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                                                                        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span>
                                                                    <span class="p">})</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">outvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">crispPlot</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outlabelsplot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">salidas</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outareas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">areas</span><span class="p">))</span></div>

<div class="viewcode-block" id="FuzzyController.graficar_prueba_pyqtgraph"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.graficar_prueba_pyqtgraph">[documentos]</a>    <span class="k">def</span> <span class="nf">graficar_prueba_pyqtgraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">no</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para actualizar la grafica en funcion de las nuevas entradas, codigo tomado y modificado de la funcion .view() de Scikit-Fuzzy y adaptado para su uso con PyQtGraph</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param ni: Numero de entradas</span>
<span class="sd">        :type ni: int</span>
<span class="sd">        :param no: Numero de salidas</span>
<span class="sd">        :type no: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">):</span>
            <span class="n">crispy</span> <span class="o">=</span> <span class="n">CrispValueCalculator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="p">)</span>
            <span class="n">ups_universe</span><span class="p">,</span> <span class="n">output_mf</span><span class="p">,</span> <span class="n">cut_mfs</span> <span class="o">=</span> <span class="n">crispy</span><span class="o">.</span><span class="n">find_memberships</span><span class="p">()</span>
            <span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ups_universe</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">etiq</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inlabelsplot</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">etiq</span><span class="p">]</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mf</span><span class="p">)</span>
                <span class="n">under_plot</span><span class="p">,</span> <span class="n">over_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inareas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">etiq</span><span class="p">]</span>
                <span class="n">under_plot</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">ups_universe</span><span class="p">,</span> <span class="n">zeros</span><span class="p">)</span>
                <span class="n">over_plot</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">ups_universe</span><span class="p">,</span> <span class="n">cut_mfs</span><span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]])</span>

            <span class="c1"># Codigo tomado de la funcion .view() de Scikit-Fuzzy y adaptado para su uso con PyQtGraph</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cut_mfs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">output_mf</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">crisp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">crisp_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="mf">0.</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cut_mfs</span><span class="p">:</span>
                            <span class="n">y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                                <span class="n">y</span><span class="p">,</span>
                                <span class="n">interp_membership</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span>
                                                  <span class="n">term</span><span class="o">.</span><span class="n">mf</span><span class="p">,</span>
                                                  <span class="n">crisp_value</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="mf">1.</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">invalues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setData</span><span class="p">([</span><span class="n">crisp_value</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">crisp_value</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">crisp_value</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">):</span>
            <span class="n">crispy</span> <span class="o">=</span> <span class="n">CrispValueCalculator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="p">)</span>
            <span class="n">ups_universe</span><span class="p">,</span> <span class="n">output_mf</span><span class="p">,</span> <span class="n">cut_mfs</span> <span class="o">=</span> <span class="n">crispy</span><span class="o">.</span><span class="n">find_memberships</span><span class="p">()</span>
            <span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ups_universe</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">etiq</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outlabelsplot</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">etiq</span><span class="p">]</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mf</span><span class="p">)</span>
                <span class="n">under_plot</span><span class="p">,</span> <span class="n">over_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outareas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">etiq</span><span class="p">]</span>
                <span class="n">under_plot</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">ups_universe</span><span class="p">,</span> <span class="n">zeros</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">label</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">cut_mfs</span><span class="p">:</span>
                    <span class="n">over_plot</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">ups_universe</span><span class="p">,</span> <span class="n">cut_mfs</span><span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">over_plot</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">ups_universe</span><span class="p">,</span> <span class="n">zeros</span><span class="p">)</span>

            <span class="c1"># Codigo tomado de la funcion .view() de Scikit-Fuzzy y adaptado para su uso con PyQtGraph</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cut_mfs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">output_mf</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">crisp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">crisp_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="mf">0.</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cut_mfs</span><span class="p">:</span>
                            <span class="n">y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                                <span class="n">y</span><span class="p">,</span>
                                <span class="n">interp_membership</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span>
                                                  <span class="n">term</span><span class="o">.</span><span class="n">mf</span><span class="p">,</span>
                                                  <span class="n">crisp_value</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="mf">1.</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">outvalues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setData</span><span class="p">([</span><span class="n">crisp_value</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">]))</span>
                    <span class="n">window</span><span class="o">.</span><span class="n">outtestlabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="o">+</span>
                                            <span class="sa">f</span><span class="s1">&#39;: {np.around(crisp_value, 3)}&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">crisp_value</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">crisp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">crisp_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="mf">0.</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cut_mfs</span><span class="p">:</span>
                                <span class="n">y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                                    <span class="n">y</span><span class="p">,</span>
                                    <span class="n">interp_membership</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span>
                                                    <span class="n">term</span><span class="o">.</span><span class="n">mf</span><span class="p">,</span>
                                                    <span class="n">crisp_value</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                            <span class="n">y</span> <span class="o">=</span> <span class="mf">1.</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">outvalues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setData</span><span class="p">([</span><span class="n">crisp_value</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">]))</span>
                        <span class="n">window</span><span class="o">.</span><span class="n">outtestlabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="o">+</span>
                                                <span class="sa">f</span><span class="s1">&#39;: {np.around(crisp_value, 3)}&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">crisp_value</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">window</span><span class="o">.</span><span class="n">outtestlabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="o">+</span>
                                                    <span class="sa">f</span><span class="s1">&#39;: error, faltan reglas&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">crisp_value</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">window</span><span class="o">.</span><span class="n">outtestlabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="o">+</span>
                                                    <span class="sa">f</span><span class="s1">&#39;: error, faltan reglas&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FuzzyController.graficar_respuesta_2d"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.graficar_respuesta_2d">[documentos]</a>    <span class="k">def</span> <span class="nf">graficar_respuesta_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">inrange</span><span class="p">,</span> <span class="n">no</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para graficar la respuesta del controlador en caso de poseer una entrada</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param inrange: Rango de la variable de entrada</span>
<span class="sd">        :type inrange: list</span>
<span class="sd">        :param no: Numero de salidas</span>
<span class="sd">        :type no: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">entrada</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">inrange</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

        <span class="n">entradas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">salidas</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">entrada</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
                <span class="n">entradas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">):</span>
                    <span class="n">salidas</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># Se muestra una grafica por cada salida</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">):</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta2ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta2ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entradas</span><span class="p">,</span> <span class="n">salidas</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta2ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta2ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta2ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta2ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta2ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="FuzzyController.graficar_respuesta_3d"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.graficar_respuesta_3d">[documentos]</a>    <span class="k">def</span> <span class="nf">graficar_respuesta_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">inrange1</span><span class="p">,</span> <span class="n">inrange2</span><span class="p">,</span> <span class="n">no</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para graficar la superficie de respuesta del controlador en caso de poseer 2 entradas</span>
<span class="sd">        </span>
<span class="sd">        :param window: Objeto que contiene a la ventana principal</span>
<span class="sd">        :type window: object</span>
<span class="sd">        :param inrange1: Rango de la variable de entrada uno</span>
<span class="sd">        :type inrange1: list</span>
<span class="sd">        :param inrange2: Rango de la variable de entrada dos</span>
<span class="sd">        :type inrange2: list</span>
<span class="sd">        :param no: Numero de salidas</span>
<span class="sd">        :type no: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">n_puntos</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="n">entrada1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">inrange1</span><span class="p">,</span> <span class="n">n_puntos</span><span class="p">)</span>
        <span class="n">entrada2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">inrange2</span><span class="p">,</span> <span class="n">n_puntos</span><span class="p">)</span>
        <span class="n">entrada1</span><span class="p">,</span> <span class="n">entrada2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">entrada1</span><span class="p">,</span> <span class="n">entrada2</span><span class="p">)</span>

        <span class="n">entrada11</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">entrada1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">)]</span>
        <span class="n">entrada22</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">entrada2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">)]</span>

        <span class="n">salidas</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">entrada1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_puntos</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_puntos</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">entrada1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">entrada2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

                <span class="c1"># Se almacenan solo los valores validos</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">):</span>
                        <span class="n">entrada11</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">entrada1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                        <span class="n">entrada22</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">entrada2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                        <span class="n">salidas</span><span class="p">[</span><span class="n">o</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">output</span><span class="p">[</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="c1"># Se grafica una superficie por cada salida</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">):</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">colorbar</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

            <span class="n">surface</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">entrada11</span><span class="p">[</span><span class="n">o</span><span class="p">],</span> <span class="n">entrada22</span><span class="p">[</span><span class="n">o</span><span class="p">],</span> <span class="n">salidas</span><span class="p">[</span><span class="n">o</span><span class="p">],</span>
                                                            <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">colorbar</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span>

            <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
            <span class="n">window</span><span class="o">.</span><span class="n">respuesta3ds</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="FuzzyController.calcular_valor"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FuzzyController.calcular_valor">[documentos]</a>    <span class="k">def</span> <span class="nf">calcular_valor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Funcion para calcular las salidas del controlador dado sus entradas, esta funcion se utiliza en la funcionalidad de simulacion de sistemas de control</span>
<span class="sd">        </span>
<span class="sd">        :param inputs: Lista con los valores de entrada</span>
<span class="sd">        :type inputs: list</span>
<span class="sd">        :param outputs: Lista vacia del tamaño del numero de salidas</span>
<span class="sd">        :type outputs: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
            <span class="c1"># Para asegurar los limites del universe de discurso</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">universe</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_inputs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)):</span>
            <span class="n">outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Controlador</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_outputs</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">outputs</span></div></div>


<div class="viewcode-block" id="FISParser"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FISParser">[documentos]</a><span class="k">class</span> <span class="nc">FISParser</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clase para cargar y exportar archivos .fis, para cargar los archivos FIS las funciones get_system, get_vars,get_var y get_rules fueron tomadas de yapflm:</span>
<span class="sd">    </span>
<span class="sd">    Yet Another Python Fuzzy Logic Module: https://github.com/sputnick1124/yapflm</span>
<span class="sd">    </span>
<span class="sd">    Para obtener los datos necesarias del .fis, de allí, se aplica la función fis_to_json para completar el parsin. En el caso de la exportación, se realiza utilizando la función json_to_fis</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FISParser.__init__"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FISParser.__init__">[documentos]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">InputList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">OutputList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">RuleEtiquetas</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor de la clase, inicializa las variables a utilizar y selecciona entre cargar el fis o exportarlo dependiendo de las variables con las que se cree el objeto</span>
<span class="sd">        </span>
<span class="sd">        :param file: Dirección del archivo a cargar o exportar</span>
<span class="sd">        :type file: str</span>
<span class="sd">        :param inputlist: Lista de variables de entrada, defaults to None</span>
<span class="sd">        :type inputlist: list, optional</span>
<span class="sd">        :param OutputList: Lista de variables de entrada, defaults to None</span>
<span class="sd">        :type OutputList: list, optional</span>
<span class="sd">        :param RuleEtiquetas: Lista con la información necesaria para crear las reglas, defaults to None</span>
<span class="sd">        :type RuleEtiquetas: list, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Cargar archivo .fis</span>
        <span class="k">if</span> <span class="n">InputList</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">OutputList</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">RuleEtiquetas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infis</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rawlines</span> <span class="o">=</span> <span class="n">infis</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">systemList</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">InputList</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RuleList</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_system</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_vars</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_rules</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Exportar archivo .fis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">file</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">InputList</span> <span class="o">=</span> <span class="n">InputList</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span> <span class="o">=</span> <span class="n">OutputList</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RuleEtiquetas</span> <span class="o">=</span> <span class="n">RuleEtiquetas</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">json_to_fis</span><span class="p">()</span></div>

<div class="viewcode-block" id="FISParser.get_system"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FISParser.get_system">[documentos]</a>    <span class="k">def</span> <span class="nf">get_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Funcion tomada de yapflm (Yet Another Python Fuzzy Logic Module) &quot;&quot;&quot;</span>

        <span class="n">end_sysblock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawlines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">systemblock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawlines</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">end_sysblock</span><span class="p">]</span>
        <span class="n">fisargs</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">parse</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{arg}</span><span class="s1">=</span><span class="si">{val}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">systemblock</span><span class="p">)</span>
        <span class="n">fissys</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;arg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fisargs</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numinputs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fissys</span><span class="p">[</span><span class="s1">&#39;numinputs&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numoutputs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fissys</span><span class="p">[</span><span class="s1">&#39;numoutputs&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numrules</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fissys</span><span class="p">[</span><span class="s1">&#39;numrules&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_varblocks</span> <span class="o">=</span> <span class="n">end_sysblock</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">systemList</span> <span class="o">=</span> <span class="n">fissys</span></div>

<div class="viewcode-block" id="FISParser.get_var"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FISParser.get_var">[documentos]</a>    <span class="k">def</span> <span class="nf">get_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">varnum</span><span class="p">,</span> <span class="n">start_line</span><span class="p">,</span> <span class="n">end_line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Funcion tomada de yapflm (Yet Another Python Fuzzy Logic Module) &quot;&quot;&quot;</span>

        <span class="n">varblock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawlines</span><span class="p">[</span><span class="n">start_line</span><span class="p">:</span><span class="n">end_line</span><span class="p">]</span>
        <span class="n">fisargs</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">parse</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{arg}</span><span class="s1">=</span><span class="si">{val}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">varblock</span><span class="p">)</span>
        <span class="n">fisvar</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;arg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fisargs</span><span class="p">}</span>

        <span class="k">if</span> <span class="s1">&#39;input&#39;</span> <span class="ow">in</span> <span class="n">vartype</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fisvar</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;output&#39;</span> <span class="ow">in</span> <span class="n">vartype</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fisvar</span><span class="p">)</span></div>

<div class="viewcode-block" id="FISParser.get_vars"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FISParser.get_vars">[documentos]</a>    <span class="k">def</span> <span class="nf">get_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Función tomada de yapflm (Yet Another Python Fuzzy Logic Module) &quot;&quot;&quot;</span>

        <span class="n">start_ruleblock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawlines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;[Rules]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">var_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">var_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rawlines</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start_varblocks</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">start_ruleblock</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">vt</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">{type}{num:d}</span><span class="s1">]&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                <span class="n">var_types</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vt</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">vt</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="n">var_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_varblocks</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">var_lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="s1">&#39;input&#39;</span> <span class="ow">in</span> <span class="n">var_types</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_var</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="n">var_types</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">var_lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="s1">&#39;output&#39;</span> <span class="ow">in</span> <span class="n">var_types</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_var</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">var_types</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">var_lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="FISParser.get_rules"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FISParser.get_rules">[documentos]</a>    <span class="k">def</span> <span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Función tomada de yapflm (Yet Another Python Fuzzy Logic Module) &quot;&quot;&quot;</span>

        <span class="n">start_ruleblock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawlines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;[Rules]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ruleblock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawlines</span><span class="p">[</span><span class="n">start_ruleblock</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
        <span class="n">antecedents</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;{a</span><span class="si">%d</span><span class="s1">:d} &#39;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">numinputs</span><span class="p">)</span> <span class="o">%</span>
                       <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numinputs</span><span class="p">)))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">consequents</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;{c</span><span class="si">%d</span><span class="s1">:d} &#39;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">numoutputs</span><span class="p">)</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numoutputs</span><span class="p">))</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">antecedents</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">consequents</span> <span class="o">+</span> <span class="s1">&#39;(</span><span class="si">{w:d}</span><span class="s1">) : </span><span class="si">{c:d}</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">ruleblock</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">antecedents</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">consequents</span> <span class="o">+</span> <span class="s1">&#39;(</span><span class="si">{w:d}</span><span class="s1">) : </span><span class="si">{c:d}</span><span class="s1">&#39;</span>
                <span class="n">rp</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numinputs</span><span class="p">):</span>
                    <span class="n">rpar</span> <span class="o">=</span> <span class="n">rp</span><span class="p">[</span><span class="s1">&#39;a</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">inp</span><span class="p">]</span>
                    <span class="n">rval</span> <span class="o">=</span> <span class="n">rpar</span> <span class="k">if</span> <span class="n">rpar</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rval</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">outp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numoutputs</span><span class="p">):</span>
                    <span class="n">rpar</span> <span class="o">=</span> <span class="n">rp</span><span class="p">[</span><span class="s1">&#39;c</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">outp</span><span class="p">]</span>
                    <span class="n">rval</span> <span class="o">=</span> <span class="n">rpar</span> <span class="k">if</span> <span class="n">rpar</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rval</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">+=</span> <span class="p">[</span><span class="n">rp</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">],</span> <span class="n">rp</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RuleList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">antecedents</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">consequents</span> <span class="o">+</span> <span class="s1">&#39;(</span><span class="si">{w:f}</span><span class="s1">) : </span><span class="si">{c:d}</span><span class="s1">&#39;</span>
                <span class="n">rp</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numinputs</span><span class="p">):</span>
                    <span class="n">rpar</span> <span class="o">=</span> <span class="n">rp</span><span class="p">[</span><span class="s1">&#39;a</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">inp</span><span class="p">]</span>
                    <span class="n">rval</span> <span class="o">=</span> <span class="n">rpar</span> <span class="k">if</span> <span class="n">rpar</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rval</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">outp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numoutputs</span><span class="p">):</span>
                    <span class="n">rpar</span> <span class="o">=</span> <span class="n">rp</span><span class="p">[</span><span class="s1">&#39;c</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">outp</span><span class="p">]</span>
                    <span class="n">rval</span> <span class="o">=</span> <span class="n">rpar</span> <span class="k">if</span> <span class="n">rpar</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rval</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">+=</span> <span class="p">[</span><span class="n">rp</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">],</span> <span class="n">rp</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RuleList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></div>

<div class="viewcode-block" id="FISParser.fis_to_json"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FISParser.fis_to_json">[documentos]</a>    <span class="k">def</span> <span class="nf">fis_to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Función para completar la creación del controlador a partir de un archivo .fis &quot;&quot;&quot;</span>

        <span class="c1"># Datos del controlador</span>
        <span class="n">ni</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">systemList</span><span class="p">[</span><span class="s1">&#39;numinputs&#39;</span><span class="p">])</span>
        <span class="n">no</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">systemList</span><span class="p">[</span><span class="s1">&#39;numoutputs&#39;</span><span class="p">])</span>
        <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">systemList</span><span class="p">[</span><span class="s1">&#39;numrules&#39;</span><span class="p">])</span>

        <span class="n">InputList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">ni</span>
        <span class="n">OutputList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">no</span>
        <span class="n">RuleEtiquetas</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Creación de las variables de entrada</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">):</span>
            <span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;nombre&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="s2">&quot;numeroE&quot;</span><span class="p">:</span>
                    <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nummfs&#39;</span><span class="p">]),</span>
                <span class="s2">&quot;etiquetas&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nummfs&#39;</span><span class="p">]),</span>
                <span class="s2">&quot;rango&quot;</span><span class="p">:</span>
                    <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span>
                        <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;range&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
            <span class="p">}</span>
            
            <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nummfs&#39;</span><span class="p">])):</span>
                <span class="n">temp_etiqueta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;mf&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ne</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">temp2</span> <span class="o">=</span> <span class="n">temp_etiqueta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="n">ne</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;nombre&quot;</span><span class="p">:</span> <span class="n">temp_etiqueta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;mf&quot;</span><span class="p">:</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;definicion&quot;</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
                <span class="p">}</span>
        
        <span class="c1"># Creación de las variables de salida</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">):</span>
            <span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;nombre&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="s2">&quot;numeroE&quot;</span><span class="p">:</span>
                    <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nummfs&#39;</span><span class="p">]),</span>
                <span class="s2">&quot;etiquetas&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nummfs&#39;</span><span class="p">]),</span>
                <span class="s2">&quot;rango&quot;</span><span class="p">:</span>
                    <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span>
                        <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;range&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())),</span>
                <span class="s2">&quot;metodo&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">systemList</span><span class="p">[</span><span class="s1">&#39;defuzzmethod&#39;</span><span class="p">]</span>
            <span class="p">}</span>

            <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;nummfs&#39;</span><span class="p">])):</span>
                <span class="n">temp_etiqueta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;mf&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ne</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">temp2</span> <span class="o">=</span> <span class="n">temp_etiqueta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="n">ne</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;nombre&quot;</span><span class="p">:</span> <span class="n">temp_etiqueta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;mf&quot;</span><span class="p">:</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;definicion&quot;</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">temp2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
                <span class="p">}</span>

        <span class="c1"># Creación de las reglas</span>
        <span class="k">for</span> <span class="n">numeror</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RuleList</span><span class="p">):</span>
            <span class="n">ril</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">rol</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">nombre</span> <span class="o">=</span> <span class="n">InputList</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
                    <span class="n">numero</span> <span class="o">=</span> <span class="n">j</span>
                    <span class="n">negacion</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">True</span>
                    <span class="n">ril</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nombre</span><span class="p">,</span> <span class="n">numero</span><span class="p">,</span> <span class="n">negacion</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">no</span> <span class="o">+</span> <span class="n">ni</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;No se permiten salidas negadas&#39;</span><span class="p">)</span>
                    <span class="n">nombre</span> <span class="o">=</span> <span class="n">OutputList</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">ni</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
                    <span class="n">numero</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">ni</span>
                    <span class="n">peso</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="n">no</span> <span class="o">+</span> <span class="n">ni</span><span class="p">])</span>
                    <span class="n">rol</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nombre</span><span class="p">,</span> <span class="n">numero</span><span class="p">,</span> <span class="n">peso</span><span class="p">])</span>

            <span class="n">and_condition</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="n">ni</span> <span class="o">+</span> <span class="n">no</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="n">RuleEtiquetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">([</span><span class="n">ril</span><span class="p">,</span> <span class="n">rol</span><span class="p">,</span> <span class="n">and_condition</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">InputList</span><span class="p">),</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">OutputList</span><span class="p">),</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">RuleEtiquetas</span><span class="p">)</span></div>

<div class="viewcode-block" id="FISParser.json_to_fis"><a class="viewcode-back" href="../codigos/rutinas_fuzzy.html#rutinas_fuzzy.FISParser.json_to_fis">[documentos]</a>    <span class="k">def</span> <span class="nf">json_to_fis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Función para exportar el controlador en formato .fis &quot;&quot;&quot;</span>

        <span class="c1"># Datos del controlador</span>
        <span class="n">ni</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">)</span>
        <span class="n">no</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">)</span>
        <span class="n">nr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RuleEtiquetas</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

            <span class="c1"># Información general del controlador</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[System]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name=&#39;{self.file.split(&#39;/&#39;)[-1].split(&#39;.&#39;)[0]}&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Type=&#39;mamdani&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Version=2.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumInputs=</span><span class="si">{ni}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumOutputs=</span><span class="si">{no}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumRules=</span><span class="si">{nr}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AndMethod=&#39;min&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OrMethod=&#39;max&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ImpMethod=&#39;min&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AggMethod=&#39;max&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DefuzzMethod=&#39;</span><span class="si">{self.OutputList[0][&#39;metodo&#39;]}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Parsin de las entradas del controlador</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">):</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Input&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name=&#39;</span><span class="si">{self.InputList[i][&#39;nombre&#39;]}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">string_temp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;rango&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Range=</span><span class="si">{string_temp}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumMFs=</span><span class="si">{self.InputList[i][&#39;numeroE&#39;]}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;numeroE&#39;</span><span class="p">]):</span>
                    <span class="n">string_temp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
                        <span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="n">ne</span><span class="p">][</span><span class="s1">&#39;definicion&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                            <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;MF{ne+1}=&#39;</span><span class="si">{self.InputList[i][&#39;etiquetas&#39;][ne][&#39;nombre&#39;]}</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;&#39;:&#39;</span><span class="si">{self.InputList[i][&#39;etiquetas&#39;][ne][&#39;mf&#39;]}</span><span class="s2">&#39;,</span><span class="si">{string_temp}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Parsin de las salidas del controlador</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">):</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Output&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name=&#39;</span><span class="si">{self.OutputList[i][&#39;nombre&#39;]}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">string_temp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;rango&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Range=</span><span class="si">{string_temp}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumMFs=</span><span class="si">{self.OutputList[i][&#39;numeroE&#39;]}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;numeroE&#39;</span><span class="p">]):</span>
                    <span class="n">string_temp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
                        <span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">][</span><span class="n">ne</span><span class="p">][</span><span class="s1">&#39;definicion&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                            <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;MF{ne+1}=&#39;</span><span class="si">{self.OutputList[i][&#39;etiquetas&#39;][ne][&#39;nombre&#39;]}</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;&#39;:&#39;</span><span class="si">{self.OutputList[i][&#39;etiquetas&#39;][ne][&#39;mf&#39;]}</span><span class="s2">&#39;,</span><span class="si">{string_temp}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Parsin de las reglas del controlador</span>
            <span class="n">rules_no_format</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RuleEtiquetas</span><span class="p">):</span>

                <span class="n">inner_rules</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="c1"># set de entradas</span>
                <span class="k">for</span> <span class="n">nir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">inputrule</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">nir</span> <span class="o">==</span> <span class="n">inputrule</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">inputrule</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                                <span class="k">for</span> <span class="n">ner</span><span class="p">,</span> <span class="n">etiqueta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">nir</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">]):</span>
                                    <span class="k">if</span> <span class="n">etiqueta</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">inputrule</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                                        <span class="n">inner_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ner</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                                        <span class="k">break</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">ner</span><span class="p">,</span> <span class="n">etiqueta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InputList</span><span class="p">[</span><span class="n">nir</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">]):</span>
                                    <span class="k">if</span> <span class="n">etiqueta</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">inputrule</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                                        <span class="n">inner_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">ner</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                                        <span class="k">break</span>

                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">continue</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">inner_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="k">break</span>

                <span class="c1"># set de salidas</span>
                <span class="k">for</span> <span class="n">nor</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">outputtrule</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">nor</span> <span class="o">==</span> <span class="n">outputtrule</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="k">for</span> <span class="n">ner</span><span class="p">,</span> <span class="n">etiqueta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OutputList</span><span class="p">[</span><span class="n">nor</span><span class="p">][</span><span class="s1">&#39;etiquetas&#39;</span><span class="p">]):</span>
                                <span class="k">if</span> <span class="n">etiqueta</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">outputtrule</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                                    <span class="n">inner_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ner</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                                    <span class="k">break</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">continue</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">inner_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">inner_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">inner_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">inner_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">rules_no_format</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">inner_rules</span><span class="p">))</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Rules]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Escribiendo las reglas en el archivo</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
                <span class="n">rule_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">j</span> <span class="o">==</span> <span class="n">ni</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">rule_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rules_no_format</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">rule_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rules_no_format</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="n">rule_str</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">ni</span> <span class="o">+</span> <span class="n">no</span><span class="p">):</span>
                    <span class="n">rule_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rules_no_format</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="n">rule_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;({str(rules_no_format[i][ni+no])})&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="n">rule_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;: {str(rules_no_format[i][ni+no+1])}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">rule_str</span><span class="p">)</span>
        <span class="k">return</span></div></div>

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Kleiver J. Carrasco M.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>